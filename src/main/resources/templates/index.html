<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gradation</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" />
    <link rel="stylesheet" href="/css/index.css" />
</head>
<body>
<div class="main-container">
    <div class="wrapper">
        <span class="text">Trello</span>
        <div class="group">

        </div>
    </div>
    <div class="group-2">
        <div class="section">
            <span class="text-5" style="font-size: x-large;">트렐로에 오신걸 환영합니다.</span>
            <div id="member">
                <div class="group-3" style="margin-bottom: 10px">
                    <div class="group-4">
                        <label><input id="email" type="text" style="border: none" placeholder="이메일을 입력해주세요."></label>
                    </div>
                </div>
                <div class="section-2" style="margin-bottom: 20px">
                    <div class="section-3">
                        <label><input id="password" type="password" style="border: none" placeholder="비밀번호를 입력해주세요."></label>
                    </div>
                </div>
                <div class="section-4">
                    <div class="wrapper-2" id="login-btn">로그인</div>
                    <div class="section-5" id="signup-btn">회원가입</div>
                </div>
            </div>
            <div id="logout">
                <button id="logout-btn">로그아웃</button>
            </div>
        </div>
        <div class="pic"></div>
    </div>
    <div class="wrapper-a">
        <div class="wrapper-b">
          <span class="text-1f">© 2024 Trello</span
          ><span class="text-20">Terms of Service</span
        ><span class="text-21">Privacy Policy</span
        ><span class="text-22">Contact Us</span>
        </div>
    </div>
</div>
<!-- Generated by Codia AI - https://codia.ai/ -->
</body>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        function getJwtFromCookie() {
            const cookies = document.cookie.split(';'); // 쿠키 문자열을 ';'로 나누어 배열로 만듦
            for (const cookie of cookies) {
                const [name, value] = cookie.trim().split('=');
                if (name === 'Authorization') {
                    document.getElementById("member").style.visibility = 'hidden';
                    document.getElementById("logout-btn").style.visibility = 'visible';
                    location.href = "/api/boards"
                } else {
                    document.getElementById("member").style.visibility = 'visible';
                    document.getElementById("logout-btn").style.visibility = 'hidden';
                }
            }
        }

        getJwtFromCookie();
    })

    document.getElementById("login-btn").addEventListener('click', function() {
        const loginData = {
            "email" : document.getElementById("email").value,
            "password" : document.getElementById("password").value
        }

        // fetch를 이용한 POST 요청 설정
        fetch('/api/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json' // JSON 형태의 데이터 전송을 명시
            },
            body: JSON.stringify(loginData) // 데이터를 JSON 문자열로 변환하여 전송
        })
            .then(data => {
                if(data.status === 200){
                    alert("로그인 되었습니다.")
                    location.href = "/api/boards"
                } else {
                    alert("아이디와 비밀번호를 확인해주세요.")
                }
            })
            .catch(error => {
                // 오류 처리
                console.log(error)
            });
    })

    document.getElementById("logout-btn").addEventListener('click', function() {
        function deleteCookie(name) {
            document.cookie = name + '=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
        }

        deleteCookie('Authorization');
        alert("로그아웃 되었습니다.")
        window.location.reload();
    })

    document.getElementById("signup-btn").addEventListener('click', function() {
        location.href = "/api/toSignup"
    })
</script>
</html>
